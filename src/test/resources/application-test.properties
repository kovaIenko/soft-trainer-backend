# Test Database Configuration
spring.datasource.url=jdbc:h2:mem:testdb;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DEFAULT_NULL_ORDERING=HIGH
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# JPA Configuration for H2
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.defer-datasource-initialization=true

# Enable SQL data initialization
spring.sql.init.mode=always
spring.sql.init.data-locations=classpath:data.sql

# Disable Flyway for tests to avoid circular dependency
spring.flyway.enabled=false

# H2 Console (for debugging)
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# OpenAI Configuration (Mock for testing)
openai.api.key=test-mock-key-for-testing
OPEN_AI_SECRET_KEY=test-mock-key-for-testing
app.openai.enabled=false

# Disable SSL for testing
server.ssl.enabled=false
server.port=8080

# Disable Spring Security completely for tests
spring.security.enabled=false
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,org.springframework.boot.autoconfigure.security.oauth2.resource.servlet.OAuth2ResourceServerAutoConfiguration

# Exclude ChatGptServiceJvmOpenAi from component scanning
spring.main.exclude=com.backend.softtrainer.services.chatgpt.ChatGptServiceJvmOpenAi

# Disable OAuth2 resource server
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=
spring.security.oauth2.resourceserver.jwt.issuer-uri=

# Disable method-level security
spring.security.method.enabled=false

# Test specific configurations
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# JMX disabled
spring.jmx.enabled=false

# Test data configuration
app.test-data.load-sample-simulations=true
app.test-data.create-test-users=true

# Dual-Mode Runtime Configuration for Testing
app.dual-mode.enabled=true
app.dual-mode.legacy-engine.enabled=true
app.dual-mode.modern-engine.enabled=false
app.dual-mode.auto-detection.enabled=true
app.dual-mode.fallback-to-legacy=true
app.dual-mode.validation.strict=false
app.dual-mode.test-mode=true
app.dual-mode.performance-monitoring=true
app.dual-mode.compatibility-logging=DEBUG

# Legacy System Configuration (Maintained for Backward Compatibility)
app.ai-agent.enhanced-processing.enabled=false
app.enhanced-messages.enabled=false

# Logging Configuration for Tests
logging.level.com.backend.softtrainer.simulation=DEBUG
logging.level.com.backend.softtrainer.services.InputMessageService=DEBUG
logging.level.com.backend.softtrainer.controllers=DEBUG

# Security Settings for Tests
app.security.jwt.enabled=false
app.security.test-mode=true 

# AI Agent Configuration for Tests
app.ai-agent.enabled=true
app.ai-agent.base-url=http://localhost:8000

# AI Agent Timeout Configuration for Tests
app.ai-agent.timeout.connection-timeout=2000
app.ai-agent.timeout.read-timeout=10000
app.ai-agent.timeout.total-timeout=12000
app.ai-agent.timeout.failure-threshold=3
app.ai-agent.timeout.reset-timeout-ms=30000
app.ai-agent.timeout.max-retries=2